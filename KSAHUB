-- Safe Speed GUI (Movable + Hide/Show)
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local enabled = false
local boostedSpeed = 32 -- default speed

-- GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

-- Main Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0,180,0,120)
frame.Position = UDim2.new(1,-190,0,20)
frame.BackgroundColor3 = Color3.fromRGB(40,40,40)
frame.Active = true
frame.Draggable = true -- تخليه يتحرك
frame.Parent = screenGui

-- Title
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1,0,0,25)
title.Text = "KSAHUB ( Safe Speed )"
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.fromRGB(255,255,255)
title.TextScaled = true

-- Close Button (X)
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0,25,0,25)
closeButton.Position = UDim2.new(1,-30,0,0)
closeButton.Text = "X"
closeButton.TextScaled = true
closeButton.Font = Enum.Font.GothamBold
closeButton.TextColor3 = Color3.fromRGB(255,255,255)
closeButton.BackgroundColor3 = Color3.fromRGB(200,0,0)
closeButton.Parent = frame

-- Speed Button
local speedButton = Instance.new("TextButton")
speedButton.Size = UDim2.new(0.45,0,0,30)
speedButton.Position = UDim2.new(0.05,0,0,35)
speedButton.Text = "OFF"
speedButton.TextScaled = true
speedButton.Font = Enum.Font.GothamBold
speedButton.TextColor3 = Color3.fromRGB(255,255,255)
speedButton.BackgroundColor3 = Color3.fromRGB(200,0,0)
speedButton.Parent = frame

-- Slider (TextBox + Label)
local sliderBox = Instance.new("TextBox")
sliderBox.Size = UDim2.new(0.45,0,0,30)
sliderBox.Position = UDim2.new(0.5,0,0,35)
sliderBox.Text = tostring(boostedSpeed)
sliderBox.TextScaled = true
sliderBox.Font = Enum.Font.GothamBold
sliderBox.TextColor3 = Color3.fromRGB(255,255,255)
sliderBox.BackgroundColor3 = Color3.fromRGB(60,60,60)
sliderBox.Parent = frame

local sliderLabel = Instance.new("TextLabel")
sliderLabel.Size = UDim2.new(1,0,0,25)
sliderLabel.Position = UDim2.new(0,0,0,75)
sliderLabel.Text = "Speed: "..boostedSpeed
sliderLabel.BackgroundTransparency = 1
sliderLabel.Font = Enum.Font.GothamBold
sliderLabel.TextColor3 = Color3.fromRGB(255,255,255)
sliderLabel.TextScaled = true
sliderLabel.Parent = frame

-- Show GUI Icon
local showButton = Instance.new("TextButton")
showButton.Size = UDim2.new(0,50,0,25)
showButton.Position = UDim2.new(0,20,0,20)
showButton.Text = "GUI"
showButton.TextScaled = true
showButton.Font = Enum.Font.GothamBold
showButton.TextColor3 = Color3.fromRGB(255,255,255)
showButton.BackgroundColor3 = Color3.fromRGB(0,150,0)
showButton.Visible = false -- مخفي في البداية
showButton.Parent = screenGui

-- Function to apply speed safely
local function applySpeed()
    if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
        player.Character:FindFirstChildOfClass("Humanoid").WalkSpeed = enabled and boostedSpeed or 16
    end
end

-- Toggle Speed
speedButton.MouseButton1Click:Connect(function()
    enabled = not enabled
    if enabled then
        speedButton.Text = "ON"
        speedButton.BackgroundColor3 = Color3.fromRGB(0,200,0)
    else
        speedButton.Text = "OFF"
        speedButton.BackgroundColor3 = Color3.fromRGB(200,0,0)
    end
    applySpeed()
end)

-- Update speed from slider
sliderBox.FocusLost:Connect(function()
    local val = tonumber(sliderBox.Text)
    if val and val >= 16 and val <= 50 then
        boostedSpeed = val
        sliderLabel.Text = "Speed: "..boostedSpeed
        applySpeed()
    else
        sliderBox.Text = tostring(boostedSpeed)
    end
end)

-- Close GUI
closeButton.MouseButton1Click:Connect(function()
    frame.Visible = false
    showButton.Visible = true
end)

-- Show GUI again
showButton.MouseButton1Click:Connect(function()
    frame.Visible = true
    showButton.Visible = false
end)
